
# NER Project - Named Entity Recognition with BERT

Fine-tuning BERT for Named Entity Recognition on the CoNLL-2003 dataset.

## ğŸ“Š Results Summary

| Metric | Value |
|--------|-------|
| **Test F1** | **91.1%** |
| Test Precision | 90.6% |
| Test Recall | 91.7% |
| Test Accuracy | 98.2% |

### Per-Entity Performance

| Entity | Precision | Recall | F1-Score |
|--------|-----------|--------|----------|
| PER | 94.9% | 95.9% | **95.4%** |
| LOC | 92.9% | 93.0% | 92.9% |
| ORG | 89.5% | 90.5% | 90.0% |
| MISC | 78.1% | 81.3% | 79.7% |

---

## ğŸ“ Project Structure

```
NER_Project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data.py          # Data loading and preprocessing
â”‚   â”œâ”€â”€ train.py         # Training script
â”‚   â””â”€â”€ evaluate.py      # Evaluation script
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ NER_Project_Report.ipynb  # Full analysis notebook
â”œâ”€â”€ outputs/             # Model outputs (NOT in submission)
â”‚   â””â”€â”€ bert/            # Trained BERT model
â”œâ”€â”€ reports/             # Reports and figures
â”‚   â”œâ”€â”€ figures/         # Generated visualizations
â”‚   â”œâ”€â”€ metrics/         # JSON result files
â”‚   â””â”€â”€ bert/            # Model-specific reports
â”œâ”€â”€ main.py              # Quick demo script
â”œâ”€â”€ requirements.txt     # Dependencies
â””â”€â”€ README.md            # This file
```

---

## ğŸ“¥ Data Download

### Dataset: CoNLL-2003
- **Source:** [HuggingFace Datasets](https://huggingface.co/datasets/conll2003)
- **URL:** https://huggingface.co/datasets/conll2003
- **Download:** Automatic via `datasets` library (no manual download needed)

The dataset is automatically downloaded when running the training script.

---

## ğŸ”§ Setup Instructions

### 1. Create Virtual Environment

**Windows (PowerShell):**
```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
```

**macOS/Linux:**
```bash
python3 -m venv .venv
source .venv/bin/activate
```

### 2. Install Dependencies

**CPU only:**
```bash
pip install -r requirements.txt
```

**With CUDA (GPU):**
```bash
# Install PyTorch with CUDA first
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
pip install -r requirements.txt
```

### 3. Data Location

Data is automatically downloaded to `~/.cache/huggingface/datasets/conll2003/`.
No manual placement needed.

---

## ğŸš€ Running the Project

### Option 1: Quick Demo
```bash
python main.py
```

### Option 2: Full Training Pipeline

**Train the model:**
```bash
python src/train.py \
    --model_name_or_path bert-base-cased \
    --output_dir outputs/bert \
    --epochs 3 \
    --per_device_train_batch_size 8
```

**Evaluate the model:**
```bash
python src/evaluate.py --model_dir outputs/bert
```

### Option 3: Jupyter Notebook

Open and run `notebooks/NER_Project_Report.ipynb` for full analysis and visualizations.

```bash
jupyter notebook notebooks/NER_Project_Report.ipynb
```

---

## ğŸ“‹ Hyperparameters

| Parameter | Value |
|-----------|-------|
| Model | bert-base-cased |
| Max Sequence Length | 128 |
| Batch Size | 8 |
| Learning Rate | 5e-5 |
| Epochs | 3 |
| Weight Decay | 0.01 |
| Optimizer | AdamW |
| FP16 | Enabled (GPU) |

---

## ğŸ“‚ Output Files

After training, results are saved to `outputs/bert/`:

| File | Description |
|------|-------------|
| `model.safetensors` | Model weights (âš ï¸ large file, not in submission) |
| `config.json` | Model configuration |
| `report.md` | Training summary report |
| `eval_report.md` | Evaluation detailed report |
| `*_results.json` | Metrics in JSON format |

---

## âš ï¸ Important Notes

1. **Do NOT include** `outputs/` folder in submission (contains large model weights)
2. **Do NOT include** `.venv/` folder
3. Model weights can be downloaded from [HuggingFace Hub](https://huggingface.co/) or regenerated by running training

---

## ğŸ”— References

1. Devlin et al. (2019). BERT: Pre-training of Deep Bidirectional Transformers
2. Sang & De Meulder (2003). CoNLL-2003 Shared Task
3. [HuggingFace Transformers](https://huggingface.co/docs/transformers/)

---

## ğŸ“ Troubleshooting

- **PyTorch CUDA version mismatch:** Visit https://pytorch.org/get-started/locally/
- **Slow installation:** Use mirror: `pip install -i https://pypi.tuna.tsinghua.edu.cn/simple`
- **Memory issues:** Reduce batch size with `--per_device_train_batch_size 4`
å¦‚æœä½ åœ¨è®­ç»ƒæœºå™¨ä¸Šå·²ç»æœ‰ `outputs/bert/`ï¼ˆåŒ…å« `report.md` / `eval_report.md` / `*results*.json`ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä»“åº“å†…çš„è„šæœ¬ä¸€é”®æ”¶é›†å¹¶æäº¤æŠ¥å‘Šï¼š

```bash
./scripts/publish_reports.sh outputs/bert main
```

è„šæœ¬ä¼šæŠŠæŠ¥å‘Šå¤åˆ¶åˆ° `reports/`ï¼Œæ·»åŠ  `reports/README.md`ï¼Œå¹¶å°è¯•å°†å˜æ›´æäº¤åˆ° `origin/main`ï¼ˆè¯·ç¡®ä¿æœ¬åœ°é…ç½®äº† git å¹¶æœ‰æ¨é€æƒé™ï¼‰ã€‚

ä¸è¦æŠŠæ¨¡å‹æ–‡ä»¶æäº¤åˆ°ä»“åº“ â€”â€” è„šæœ¬åªä¼šæ”¶é›†å°æ–‡æœ¬/JSON æŠ¥å‘Šæ–‡ä»¶ã€‚
